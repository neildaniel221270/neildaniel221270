<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>evaluation_metrics Module &#8212; Computer Vision 3 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=8d563738"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="instance_segmentation Module" href="instance_segmentation.html" />
    <link rel="prev" title="data_preprocessing Module" href="data_preprocessing.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="evaluation-metrics-module">
<h1>evaluation_metrics Module<a class="headerlink" href="#evaluation-metrics-module" title="Link to this heading">¶</a></h1>
<dl class="py function" id="module-evaluation_metrics">
<dt class="sig sig-object py" id="evaluation_metrics.f1">
<span class="sig-prename descclassname"><span class="pre">evaluation_metrics.</span></span><span class="sig-name descname"><span class="pre">f1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#evaluation_metrics.f1" title="Link to this definition">¶</a></dt>
<dd><p>Compute the F1 score metric for binary classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>keras.tensor.Tensor</em>) – True labels.</p></li>
<li><p><strong>y_pred</strong> (<em>keras.tensor.Tensor</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>F1 score value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>keras.tensor.Tensor</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Rens van den Berg</p>
</dd>
</dl>
<p><strong>Usage:</strong></p>
<p>This function calculates the F1 score for binary classification tasks.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">keras.backend</span> <span class="k">as</span> <span class="nn">K</span>
<span class="kn">from</span> <span class="nn">your_module</span> <span class="kn">import</span> <span class="n">f1</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">f1_score</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">f1_score</span><span class="p">))</span>  <span class="c1"># Output: 0.6666667</span>
</pre></div>
</div>
<p><strong>Details:</strong></p>
<p>The function first defines two helper functions:</p>
<ul class="simple">
<li><p><cite>recall_m</cite>: Computes the recall metric.</p></li>
<li><p><cite>precision_m</cite>: Computes the precision metric.</p></li>
</ul>
<p>The F1 score is then computed as the harmonic mean of precision and recall.</p>
<p>The function returns the F1 score as a Keras tensor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="evaluation_metrics.iou">
<span class="sig-prename descclassname"><span class="pre">evaluation_metrics.</span></span><span class="sig-name descname"><span class="pre">iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#evaluation_metrics.iou" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Intersection over Union (IoU) metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>keras.tensor.Tensor</em>) – True labels.</p></li>
<li><p><strong>y_pred</strong> (<em>keras.tensor.Tensor</em>) – Predicted labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>IoU score value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>keras.tensor.Tensor</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Rens van den Berg</p>
</dd>
</dl>
<p><strong>Usage:</strong></p>
<p>This function calculates the Intersection over Union (IoU) for evaluating the accuracy of an object detector on a particular dataset.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">keras.backend</span> <span class="k">as</span> <span class="nn">K</span>
<span class="kn">from</span> <span class="nn">your_module</span> <span class="kn">import</span> <span class="n">iou</span>

<span class="n">y_true</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">([[[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]]])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">([[[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]])</span>

<span class="n">iou_score</span> <span class="o">=</span> <span class="n">iou</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">iou_score</span><span class="p">))</span>  <span class="c1"># Output: 0.33333334</span>
</pre></div>
</div>
<p><strong>Details:</strong></p>
<p>The function defines a helper function <cite>f</cite> that calculates the IoU for each image in the batch. The IoU is computed as the ratio of the intersection area to the union area of the true and predicted labels.</p>
<p>The function returns the mean IoU score across the batch as a Keras tensor.</p>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Computer Vision 3</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data_loading.html">data_loading Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_preprocessing.html">data_preprocessing Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">evaluation_metrics Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#evaluation_metrics.f1"><code class="docutils literal notranslate"><span class="pre">f1()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#evaluation_metrics.iou"><code class="docutils literal notranslate"><span class="pre">iou()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="instance_segmentation.html">instance_segmentation Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="landmarks_detection.html">landmarks_detection Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">main Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mask_prediction.html">mask_prediction Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_creation.html">model_creation Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_evaluation.html">model_evaluation Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_training.html">model_training Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="root_length_measurement.html">root_length_measurement Module</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="data_preprocessing.html" title="previous chapter">data_preprocessing Module</a></li>
      <li>Next: <a href="instance_segmentation.html" title="next chapter">instance_segmentation Module</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Michal Dziechciarz, Rens van den Berg, Stijn Heesters, Lea Bancovac, Neil Ross Daniel.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/evaluation_metrics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>