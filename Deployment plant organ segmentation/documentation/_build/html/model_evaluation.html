<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>model_evaluation Module &#8212; Computer Vision 3 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=8d563738"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="model_training Module" href="model_training.html" />
    <link rel="prev" title="model_creation Module" href="model_creation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="model-evaluation-module">
<h1>model_evaluation Module<a class="headerlink" href="#model-evaluation-module" title="Link to this heading">¶</a></h1>
<dl class="py function" id="module-model_evaluation">
<dt class="sig sig-object py" id="model_evaluation.evaluate_model">
<span class="sig-prename descclassname"><span class="pre">model_evaluation.</span></span><span class="sig-name descname"><span class="pre">evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataset_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mlflow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model_evaluation.evaluate_model" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the performance of a trained model on a test dataset.</p>
<p>This function calculates the Intersection over Union (IoU), accuracy, and F1 score of the model’s predictions
on the provided test dataset. The test dataset should contain images and corresponding ground truth masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>keras.Model</em>) – Trained model to be evaluated.</p></li>
<li><p><strong>test_dataset_path</strong> (<em>str</em>) – Path to the directory containing the test dataset. The directory should have
subdirectories ‘images/images’ for test images and ‘masks/masks’ for ground truth masks.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the IoU, accuracy, and F1 score of the model’s predictions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Stijn Heesters</p>
</dd>
</dl>
<p><strong>Usage:</strong></p>
<p>This function evaluates the model’s performance on the test dataset and returns the evaluation metrics.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">your_module</span> <span class="kn">import</span> <span class="n">evaluate_model</span>

<span class="n">test_dataset_path</span> <span class="o">=</span> <span class="s2">&quot;path/to/test_dataset&quot;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_trained_model</span><span class="p">(</span><span class="s2">&quot;path/to/trained_model.h5&quot;</span><span class="p">)</span>
<span class="n">evaluation_metrics</span> <span class="o">=</span> <span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_dataset_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evaluation_metrics</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Details:</strong></p>
<ul class="simple">
<li><p>Loads the test images and ground truth masks from the specified directory.</p></li>
<li><p>Makes predictions using the provided model.</p></li>
<li><p>Computes the IoU, accuracy, and F1 score for the model’s predictions.</p></li>
<li><p>Returns the evaluation metrics in a dictionary.</p></li>
</ul>
<p><strong>Dependencies:</strong></p>
<p>This function requires the following libraries:
- numpy
- glob
- os
- cv2 (OpenCV)
- keras
- sklearn.metrics (for accuracy_score)
- skimage.morphology (for skeletonize)
- networkx (for graph operations)
- skan (for skeleton analysis)</p>
<dl class="field-list simple">
<dt class="field-odd">Note<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ensure that the input model is a trained keras model and the test dataset directory structure is correct.</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Computer Vision 3</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data_loading.html">data_loading Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_preprocessing.html">data_preprocessing Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation_metrics.html">evaluation_metrics Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="instance_segmentation.html">instance_segmentation Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="landmarks_detection.html">landmarks_detection Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="main.html">main Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mask_prediction.html">mask_prediction Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_creation.html">model_creation Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">model_evaluation Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model_evaluation.evaluate_model"><code class="docutils literal notranslate"><span class="pre">evaluate_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_training.html">model_training Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="root_length_measurement.html">root_length_measurement Module</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="model_creation.html" title="previous chapter">model_creation Module</a></li>
      <li>Next: <a href="model_training.html" title="next chapter">model_training Module</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Michal Dziechciarz, Rens van den Berg, Stijn Heesters, Lea Bancovac, Neil Ross Daniel.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/model_evaluation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>